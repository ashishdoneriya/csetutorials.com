<!doctype html><html lang=hi><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAQAAABLCVATAAAAdUlEQVR4Ae3MIRJAUBCH8e81R3AO53AmvIQmu5MzqE8iKoZAEdZYZhT7/cuGnR9/yeEJrDcW8DjEKlbFasQmFTQitj+cK2TqO8ggg2LceygiZ6YjeQel9Me10NI8ghR7DhlkkEFBxQTEShVUcVHGcAsZ8PylDecfc51kCzSlAAAAAElFTkSuQmCC type=image/x-icon><link rel=preload href=https://csetutorials.com/fonts/Roboto.ttf as=font type=font/ttf crossorigin=anonymous><link rel=preload href=https://csetutorials.com/fonts/RobotoMono.ttf as=font type=font/ttf crossorigin=anonymous><link rel=preload href=https://csetutorials.com/fonts/Roboto-Italic.ttf as=font type=font/ttf crossorigin=anonymous><link rel=preload href=https://csetutorials.com/fonts/RobotoMono-Italic.ttf as=font type=font/ttf crossorigin=anonymous><link rel=stylesheet href=https://csetutorials.com/scss/main.min.css><title>How to setup Kerberos on Ubuntu</title>
<meta name=description content="Steps to setup Kerberos server, administrative server and Kerberos client on Ubuntu Linux and also setup Kerberos authentication"><meta name=author content="Ashish Doneriya"><meta name=robots content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><link rel=canonical href=https://csetutorials.com/setup-kerberos-ubuntu.html><meta property="og:type" content="article"><meta property="og:title" content="How to setup Kerberos on Ubuntu"><meta property="og:description" content="Steps to setup Kerberos server, administrative server and Kerberos client on Ubuntu Linux and also setup Kerberos authentication"><meta name=keywords content="kerberos"><meta property="og:url" content="https://csetutorials.com/setup-kerberos-ubuntu.html"><meta property="og:site_name" content="Cse Tutorials"><meta property="article:published_time" content="2017-07-05T08:40:58+05:30"><meta property="article:modified_time" content="2017-07-05T08:40:58+05:30"><meta property="article:author" content="Ashish Doneriya"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="How to setup Kerberos on Ubuntu"><meta name=twitter:description content="Steps to setup Kerberos server, administrative server and Kerberos client on Ubuntu Linux and also setup Kerberos authentication"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","headline":"How to setup Kerberos on Ubuntu","description":"Steps to setup Kerberos server, administrative server and Kerberos client on Ubuntu Linux and also setup Kerberos authentication","author":{"@type":"Person","name":"Ashish Doneriya"},"keywords":["\"%!s(MISSING)\""],"articleSection":["\"%!s(MISSING)\""],"datePublished":"2017-07-05T08:40:58\u002b05:30","dateModified":"2017-07-05T08:40:58\u002b05:30","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/csetutorials.com\/setup-kerberos-ubuntu.html"},"url":"https:\/\/csetutorials.com\/setup-kerberos-ubuntu.html"}</script></head><body><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><div class=container><a class=navbar-brand href=/>Cse Tutorials</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarNav aria-controls=navbarNav aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end" id=navbarNav><ul class=navbar-nav><li class=nav-item><a class=nav-link href=/about-us/>About us</a></li><li class=nav-item><a class=nav-link href=/contact-us/>Contact us</a></li><li class=nav-item><a class=nav-link href=/privacy-policy/>Privacy Policy</a></li><li class=nav-item><a class=nav-link href=/terms-of-service/>Terms of Service</a></li><li class=nav-item><a class=nav-link href=/topics/>Topics</a></li></ul></div></div></nav><main><article class=page-wrapper><h1 class="mb-4 text-center">How to setup Kerberos on Ubuntu</h1><div class="d-flex justify-content-center align-items-center mb-4 text-muted small"><time datetime="2017-07-05 08:40:58 +0530 +0530">Jul 5, 2017</time>
<span class=mx-2>|</span>
<span>Ashish Doneriya</span>
<span class=mx-2>|</span>
<a class=text-decoration-none href=/topics/ubuntu rel=category>Ubuntu</a></div><div class=post-content><p>In a network, there is one machine which acts as a server for Kerberos authentication and rest of the machines act as clients. On the server machine, we will install Kerberos administrative server and database for Kerberos. On client machines, we will install Kerberos client. So first we will setup Kerberos server.</p><h2 id=setting-kerberos-server>Setting Kerberos Server</h2><p>Execute the below command to install Kerberos admin server and KDE (key distribution center).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install krb5-kdc krb5-admin-server
</span></span></code></pre></div><p>It will ask you the following three things one by one</p><ol><li>Kerberos realm. (let&rsquo;s say MYREALM)</li><li>Kerberos server hostname. Type <code>localhost</code> and enter.</li><li>Hostname of the administrative (password changing) server for MYREALM. In this case type <code>localhost</code> and enter.<br><img src=/wp-content/uploads/2017/07/kerberos-installation-1.png alt="Kerberos installation">
<img src=/wp-content/uploads/2017/07/kerberos-installation-2.png alt="Kerberos installation">
<img src=/wp-content/uploads/2017/07/kerberos-installation-3.png alt="Kerberos installation">
<img src=/wp-content/uploads/2017/07/kerberos-installation-4.png alt="Kerberos installation"></li></ol><p>Now execute the below command to setup realm.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo krb5_newrealm
</span></span></code></pre></div><p>It will ask you to enter a password for database creation and after that, it will start Kerberos KDC krb5kdc and Kerberos administrative servers kadmind processes.</p><p>Open <code>/etc/krb5kdc/kadm5.acl</code> file with your favourite text editor and uncomment the last line so that the file would look like.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># This file Is the access control list for krb5 administration.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># When this file is edited run /etc/init.d/krb5-admin-server restart to activate</span>
</span></span><span style=display:flex><span><span style=color:#75715e># One common way to set up Kerberos administration is to allow any principal</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ending in /admin  is given full administrative rights.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># To enable this, uncomment the following line:</span>
</span></span><span style=display:flex><span>*/admin *
</span></span></code></pre></div><p>Your Kerberos server has been setup.</p><p>If you want to add principal, execute</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo kadmin.local
</span></span></code></pre></div><p>and then run the command <code>addprinc</code> inside <code>kadmin.local</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>addprinc your_principal_name
</span></span></code></pre></div><p>eg.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>addprinc ashishdoneriya
</span></span></code></pre></div><h2 id=setting-kerberos-client>Setting Kerberos Client</h2><p>Add Kerberos server machine entry in your client machine /etc/hosts file. Let&rsquo;s say the hostname of the machine in which you have just installed Kerberos server is &lsquo;host1&rsquo; and IP is &lsquo;192.168.1.10&rsquo; then add this line to /etc/hosts</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>192.168.1.10    host1
</span></span></code></pre></div><p>Execute the below command to install and setup Kerberos client.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install krb5-user
</span></span></code></pre></div><p>It will ask 3 thing one by one<br>realm - MYREALM<br>hostname - host1<br>admin server - host1</p><p>That&rsquo;s it. Now to test, run command</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kinit -p your_principal_name@MYREALM
</span></span></code></pre></div><p>eg.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kinit -p ashishdoneriya@MYREALM
</span></span></code></pre></div><p>If you want to remove kerberos and all its configuration and pacakages from your system then</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get remove --purge krb5-admin-server krb5-config krb5-kdc krb5-locales
</span></span></code></pre></div><p><strong>Update :</strong> Once I had to setup kerberos client on my machine and the kdc is MIT kdc. Then I setup client on my machine using above process. After that I was facing problems in java during authentication and authorization using kerberos. After a lot of debugging, I found that in my system, encryption types in file <code>/etc/krb5.conf</code> is different than kerberos server&rsquo;s <code>/etc/krb5.conf</code>. So I replaced my system&rsquo;s <code>/etc/krb5.conf</code> with server&rsquo;s and then my java code worked fine.</p><p>Sources:</p><ul><li><a href=https://help.ubuntu.com/community/Kerberos target=_blank rel="noopener nofollow">https://help.ubuntu.com/community/Kerberos</a></li><li><a href=https://help.ubuntu.com/lts/serverguide/kerberos.html target=_blank rel="noopener nofollow">https://help.ubuntu.com/lts/serverguide/kerberos.html</a></li></ul></div></article></main><script async src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js defer></script></body></html>